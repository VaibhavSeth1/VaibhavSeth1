name: Update README with latest repos

on:
  schedule:
    - cron: "0 0 * * *" # Runs daily
  workflow_dispatch:

jobs:
  update-readme:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - name: Update README
        uses: actions/github-script@v6
        with:
          script: |
            const username = "VaibhavSeth1";
            const res = await fetch(`https://api.github.com/users/${username}/repos?sort=created&per_page=2`);
            const repos = await res.json();
            const markdown = repos.map(repo => `- [${repo.name}](${repo.html_url})`).join("\n");

            const fs = require("fs");
            let readme = fs.readFileSync("README.md", "utf8");
            readme = readme.replace(/<!-- RECENT_REPOS -->[\s\S]*?<!-- END_RECENT_REPOS -->/, `<!-- RECENT_REPOS -->\n${markdown}\n<!-- END_RECENT_REPOS -->`);
            fs.writeFileSync("README.md", readme);

